<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phone Simulator â€” Voice AI Agent</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #0f172a; font-family: 'Inter', system-ui, sans-serif; }

    /* Pulsing call button */
    .pulse-ring {
      animation: pulse-ring 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
    }
    @keyframes pulse-ring {
      0% { transform: scale(0.9); opacity: 0.7; }
      50% { transform: scale(1.15); opacity: 0; }
      100% { transform: scale(0.9); opacity: 0; }
    }

    /* Waveform bars */
    .wave-bar {
      animation: wave 0.6s ease-in-out infinite alternate;
      background: #22c55e;
      border-radius: 2px;
    }
    .wave-bar:nth-child(2) { animation-delay: 0.1s; }
    .wave-bar:nth-child(3) { animation-delay: 0.2s; }
    .wave-bar:nth-child(4) { animation-delay: 0.3s; }
    .wave-bar:nth-child(5) { animation-delay: 0.15s; }
    @keyframes wave {
      from { height: 4px; }
      to   { height: 28px; }
    }

    .wave-bar.speaking { background: #a855f7; }
    .wave-bar.idle { animation: none; height: 4px; background: #475569; }

    /* Transcript bubbles */
    .msg-user {
      background: #1e40af;
      border-radius: 16px 16px 4px 16px;
      max-width: 80%;
      margin-left: auto;
    }
    .msg-ai {
      background: #1e293b;
      border: 1px solid #334155;
      border-radius: 16px 16px 16px 4px;
      max-width: 80%;
    }
    .msg-fn {
      background: #1a1a2e;
      border: 1px dashed #fbbf24;
      border-radius: 8px;
      max-width: 90%;
      margin: 0 auto;
    }

    /* Smooth scroll */
    #transcript { scroll-behavior: smooth; }

    /* Status dot animation */
    .dot-pulse { animation: dot-pulse 1s ease-in-out infinite; }
    @keyframes dot-pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

  <div class="w-full max-w-md">

    <!-- Phone Card -->
    <div class="bg-slate-900 rounded-3xl shadow-2xl border border-slate-800 overflow-hidden">

      <!-- Header -->
      <div class="bg-slate-800/50 px-6 py-4 border-b border-slate-700 text-center">
        <p class="text-slate-400 text-xs uppercase tracking-widest">Phone Simulator</p>
        <h1 class="text-white text-lg font-semibold mt-1">Riverside Medical Clinic</h1>
        <p class="text-slate-500 text-sm">+1 (555) 000-1234</p>
      </div>

      <!-- Status Area -->
      <div class="px-6 py-6 text-center">

        <!-- Status text -->
        <div id="status-area">
          <p id="status-text" class="text-slate-400 text-sm">Tap the button to start a call</p>
          <p id="timer" class="text-slate-600 text-2xl font-mono mt-2 hidden">00:00</p>
        </div>

        <!-- Waveform visualiser -->
        <div id="waveform" class="flex items-center justify-center gap-1 h-10 mt-4 hidden">
          <div class="wave-bar idle w-1"></div>
          <div class="wave-bar idle w-1"></div>
          <div class="wave-bar idle w-1"></div>
          <div class="wave-bar idle w-1"></div>
          <div class="wave-bar idle w-1"></div>
        </div>

        <!-- AI Status badge -->
        <div id="ai-badge" class="mt-3 hidden">
          <span class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-slate-800 text-slate-300">
            <span id="ai-dot" class="w-2 h-2 rounded-full bg-green-500 dot-pulse"></span>
            <span id="ai-status-label">Listening</span>
          </span>
        </div>
      </div>

      <!-- Call Button -->
      <div class="flex justify-center pb-6 relative">
        <!-- Pulse ring (behind button) -->
        <div id="pulse" class="absolute w-20 h-20 rounded-full bg-green-500/30 pulse-ring hidden"></div>

        <button id="call-btn"
                onclick="toggleCall()"
                class="relative z-10 w-16 h-16 rounded-full flex items-center justify-center text-white text-2xl shadow-lg transition-all duration-300 bg-green-600 hover:bg-green-500 active:scale-95">
          <svg id="icon-phone" xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
          </svg>
          <svg id="icon-hangup" xmlns="http://www.w3.org/2000/svg" class="w-7 h-7 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16 8l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M5 3a2 2 0 00-2 2v1c0 8.284 6.716 15 15 15h1a2 2 0 002-2v-3.28a1 1 0 00-.684-.948l-4.493-1.498a1 1 0 00-1.21.502l-1.13 2.257a11.042 11.042 0 01-5.516-5.516l2.257-1.13a1 1 0 00.502-1.21L8.228 3.684A1 1 0 007.28 3H5z" />
          </svg>
        </button>
      </div>

      <!-- Transcript -->
      <div class="border-t border-slate-700">
        <div class="px-4 py-2 flex items-center justify-between">
          <span class="text-slate-500 text-xs font-medium uppercase tracking-wider">Live Transcript</span>
          <span id="transcript-count" class="text-slate-600 text-xs">0 messages</span>
        </div>
        <div id="transcript" class="px-4 pb-4 space-y-2 h-64 overflow-y-auto">
          <p class="text-slate-600 text-sm text-center py-8">Transcript will appear here during the call</p>
        </div>
      </div>

    </div>

    <!-- Dashboard link -->
    <div class="text-center mt-4">
      <a href="/dashboard" target="_blank" class="text-slate-500 hover:text-slate-300 text-sm underline">
        Open Dashboard in new tab &rarr;
      </a>
    </div>

  </div>

  <script src="/simulator/simulator.js"></script>
</body>
</html>
